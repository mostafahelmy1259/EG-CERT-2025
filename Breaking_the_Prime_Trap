from Crypto.Util.number import long_to_bytes
from gmpy2 import iroot

# Given values
pubkey = (794843286114340832937274247193948420089902182755014199528921295637210305200328587668616186133819067316785454552924146435840770874166806088937452806012334117337386292864116586477971298105757652282915038541849904725009337112093383950030704640274180807386682877019074564251511275890840240121448055086002288966748360984911108419834863481171952484614052962810206219066764291219598086447254246860624236668236478056258963733722758654273938067485028610173819043353282733, 28279027668612220027472571205905263716099645264091658845536418736907905144507460941394263413557074092386889590391519095692083271106136008337583760769047051)
enc = 17636310734724268514148597730163668769837346602221762363609922256861143846418408587768242074126402077439373175049448819740553262828013726970942852569807934340213398252977439712179700333461790743336806373352287990872720947367917871336794418077350927785285919778776858796740825961540826260764764353884106835097035783224939698572470230493078310270541434323160277872286927559839368468621436037250153102582931682349390185974479312703931312454868503375022279511495019569911614215737820584966549295147291681270061996762272518097787398343377278769644286056027377623498249305597043213403126216591660330257226267819448564789744

A, B = pubkey
e = 65537

# Compute the private exponent for B
d_B = pow(e, -1, B - 1)

# Decrypt modulo B
m = pow(enc % B, d_B, B)

# Convert the decrypted message to bytes
flag = long_to_bytes(m).decode()

print(flag)
